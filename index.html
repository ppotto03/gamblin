<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SUPER 9 BET - PREMIERE</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        :root {
            --bg-color: #080808;
            --card-bg: #121212;
            --text-gold: #eebb4d;
            --neon-gold: 0 0 15px rgba(238, 187, 77, 0.5);
            --neon-red: 0 0 15px rgba(255, 7, 58, 0.5);
            --input-bg: rgba(255, 255, 255, 0.05);
        }

        body {
            background-color: var(--bg-color);
            color: #fff;
            font-family: 'Noto Sans KR', sans-serif;
            margin: 0; padding: 0;
            overflow-x: hidden;
        }

        /* --- ÌîÑÎ¶¨ÎØ∏ÏóÑ ÏûÖÎ†•Ï∞Ω Ïä§ÌÉÄÏùº --- */
        input[type="email"], input[type="password"], input[type="number"] {
            background: var(--input-bg);
            border: 1px solid #333;
            color: #fff;
            padding: 14px 20px;
            border-radius: 12px;
            font-size: 16px;
            width: 100%;
            box-sizing: border-box;
            margin-bottom: 12px;
            transition: all 0.3s;
            outline: none;
        }
        input:focus {
            border-color: var(--text-gold);
            background: rgba(238, 187, 77, 0.05);
            box-shadow: var(--neon-gold);
        }

        /* --- ÏÑ∏Î†®Îêú Î≤ÑÌäº Ïä§ÌÉÄÏùº --- */
        .btn-main {
            background: linear-gradient(135deg, #f3d078, #eebb4d);
            color: #000; font-weight: 900; padding: 16px;
            border: none; border-radius: 12px; width: 100%;
            cursor: pointer; box-shadow: var(--neon-gold);
            font-size: 17px; transition: 0.3s;
        }
        .btn-main:hover { transform: translateY(-2px); filter: brightness(1.1); }

        .btn-max {
            background: #222; color: var(--text-gold);
            border: 1px solid var(--text-gold);
            padding: 5px 12px; border-radius: 6px;
            font-size: 12px; font-weight: 800; cursor: pointer;
            transition: 0.2s; margin-left: 5px;
        }
        .btn-max:hover { background: var(--text-gold); color: #000; }

        /* --- Î†àÏù¥ÏïÑÏõÉ --- */
        .app-header {
            display: flex; justify-content: space-between; align-items: center;
            padding: 15px 20px; background: rgba(0,0,0,0.8);
            backdrop-filter: blur(10px); border-bottom: 1px solid #222;
            position: sticky; top: 0; z-index: 1000;
        }
        .logo { font-size: 22px; font-weight: 900; font-style: italic; letter-spacing: -1px; }
        .logo span { color: #ff073a; text-shadow: var(--neon-red); }

        .balance-badge {
            background: #1a1a1a; border: 1px solid var(--text-gold);
            padding: 6px 15px; border-radius: 20px; font-weight: 800; color: var(--text-gold);
        }

        .view { display: none; animation: fadeIn 0.4s; }
        .active-view { display: block; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* --- Í≤åÏûÑ Ï†ÑÏö© UI --- */
        .ingame-card {
            max-width: 600px; margin: 20px auto; background: #111;
            border-radius: 20px; padding: 25px; border: 1px solid #222;
        }

        /* Ïä¨Î°Ø Î®∏Ïã† */
        .slot-machine {
            background: #000; border: 4px solid var(--text-gold);
            border-radius: 20px; display: flex; justify-content: space-around;
            padding: 25px 10px; margin-bottom: 20px; box-shadow: var(--neon-gold);
        }
        .reel {
            width: 80px; height: 100px; background: #1a1a1a;
            border-radius: 12px; display: flex; align-items: center;
            justify-content: center; font-size: 50px;
        }

        /* Î∞îÏπ¥Îùº Ïπ¥Îìú Ïï†ÎãàÎ©îÏù¥ÏÖò */
        .baccarat-table {
            background: radial-gradient(circle, #0a4d26 0%, #052914 100%);
            border: 8px solid #3d2b1f; border-radius: 100px 100px 20px 20px;
            height: 250px; position: relative; margin-bottom: 20px;
            display: flex; justify-content: center; align-items: center; gap: 40px;
        }
        .card-slot { text-align: center; }
        .playing-card {
            width: 70px; height: 100px; background: #fff; border-radius: 5px;
            color: #000; display: flex; align-items: center; justify-content: center;
            font-size: 30px; font-weight: bold; margin: 5px auto;
            box-shadow: 3px 3px 10px rgba(0,0,0,0.5);
            transition: transform 0.6s cubic-bezier(0.23, 1, 0.32, 1);
        }
        .card-hidden { transform: rotateY(180deg); background: #c0392b !important; color: transparent !important; }

        /* Î°úÎπÑ Í∑∏Î¶¨Îìú */
        .game-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; padding: 20px; }
        .game-item {
            background: var(--card-bg); border-radius: 15px; overflow: hidden;
            border: 1px solid #222; cursor: pointer; transition: 0.3s;
        }
        .game-item:hover { border-color: var(--text-gold); transform: translateY(-5px); }
        .game-img { width: 100%; height: 120px; background-size: cover; background-position: center; }
        .game-name { padding: 12px; font-weight: bold; font-size: 15px; }

    </style>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-app.js";
        import { getAuth, signInWithEmailAndPassword, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-auth.js";
        import { getFirestore, doc, getDoc, updateDoc, increment, arrayUnion } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyDOVJtg5lxJTBP2Vm1mzbuecKu9Rg-I4k4",
            authDomain: "gambling-23339.firebaseapp.com",
            projectId: "gambling-23339",
            storageBucket: "gambling-23339.firebasestorage.app",
            messagingSenderId: "1031894079454",
            appId: "1:1031894079454:web:960ca0f1748493cdd9af4f"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        let userData = { balance: 0 };

        window.showView = (id) => {
            document.querySelectorAll('.view').forEach(v => v.classList.remove('active-view'));
            document.getElementById(id).classList.add('active-view');
            if(id === 'snailGame') startSnailLoop();
        };

        const refresh = async () => {
            if(!auth.currentUser) return;
            const snap = await getDoc(doc(db, "users", auth.currentUser.uid));
            userData = snap.data();
            document.querySelectorAll('.balance-val').forEach(el => el.innerText = userData.balance.toLocaleString());
        };

        onAuthStateChanged(auth, (user) => { user ? (refresh(), showView('lobby')) : showView('login'); });

        window.login = async () => {
            try {
                await signInWithEmailAndPassword(auth, document.getElementById('email').value, document.getElementById('pw').value);
            } catch(e) { alert("Î°úÍ∑∏Ïù∏ Ïã§Ìå®: " + e.message); }
        };

        // --- Ïä¨Î°Ø Î®∏Ïã† (9Í∞ú Ïã¨Î≥º, 17.7Î∞∞ Ïû≠Ìåü) ---
        const slotItems = ['üçé', 'üçä', 'üçá', 'üçí', 'üíé', '7', 'üçâ', 'üçã', 'üí∞'];
        window.runSlot = async () => {
            const bet = parseInt(document.getElementById('slot-bet').value);
            if(bet > userData.balance || bet <= 0) return alert("ÏûîÏï° Î∂ÄÏ°±");

            await updateDoc(doc(db, "users", auth.currentUser.uid), { balance: increment(-bet) });
            refresh();

            let count = 0;
            const reels = [document.getElementById('r1'), document.getElementById('r2'), document.getElementById('r3')];
            const spin = setInterval(async () => {
                reels.forEach(r => r.innerText = slotItems[Math.floor(Math.random()*9)]);
                if(++count > 20) {
                    clearInterval(spin);
                    const res = reels.map(r => r.innerText);
                    let multi = 0;
                    if(res[0]==='7' && res[1]==='7' && res[2]==='7') multi = 17.7;
                    else if(res[0]===res[1] && res[1]===res[2]) multi = 2;
                    else if(res[0]===res[1] || res[1]===res[2] || res[0]===res[2]) multi = 1;

                    const profit = Math.floor(bet * multi);
                    await updateDoc(doc(db, "users", auth.currentUser.uid), {
                        balance: increment(profit),
                        history: arrayUnion({ game: 'slot', bet, profit: profit-bet, time: new Date().toISOString() })
                    });
                    refresh();
                    if(multi >= 1) alert(multi === 17.7 ? "üéä Ï¥àÎåÄÌòï Ïû≠Ìåü! 17.7Î∞∞! üéä" : "ÎãπÏ≤®ÎêòÏóàÏäµÎãàÎã§!");
                }
            }, 60);
        };

        // --- Î∞îÏπ¥Îùº (ÌÖåÏù¥Î∏î Î≥µÍµ¨ & 10Î∞∞ ÌÉÄÏù¥) ---
        window.runBac = async (pick) => {
            const bet = parseInt(document.getElementById('bac-bet').value);
            if(bet > userData.balance || bet <= 0) return alert("ÏûîÏï° Î∂ÄÏ°±");

            await updateDoc(doc(db, "users", auth.currentUser.uid), { balance: increment(-bet) });
            refresh();

            // Ïπ¥Îìú Î¶¨ÏÖã
            const pCard = document.getElementById('p-card');
            const bCard = document.getElementById('b-card');
            pCard.classList.add('card-hidden'); bCard.classList.add('card-hidden');

            setTimeout(async () => {
                const pVal = Math.floor(Math.random()*10);
                const bVal = Math.floor(Math.random()*10);
                
                pCard.innerText = pVal; pCard.classList.remove('card-hidden');
                
                setTimeout(async () => {
                    bCard.innerText = bVal; bCard.classList.remove('card-hidden');
                    
                    let result = pVal > bVal ? 'player' : (bVal > pVal ? 'banker' : 'tie');
                    let multi = 0;
                    if(pick === result) multi = (result === 'tie' ? 10 : 2);

                    const profit = bet * multi;
                    await updateDoc(doc(db, "users", auth.currentUser.uid), {
                        balance: increment(profit),
                        history: arrayUnion({ game: 'baccarat', bet, profit: profit-bet, time: new Date().toISOString() })
                    });
                    refresh();
                }, 800);
            }, 800);
        };

        // --- Îã¨ÌåΩÏù¥ (Snail Ïù¥ÎØ∏ÏßÄ & Ìùô Î∞∞Í≤Ω) ---
        let snailPos = [10, 10, 10];
        const snailImg = new Image(); snailImg.src = "https://cdn-icons-png.flaticon.com/512/826/826912.png";
        const soilImg = new Image(); soilImg.src = "https://www.transparenttextures.com/patterns/dark-matter.png"; // Ìùô ÎäêÎÇå ÌÖçÏä§Ï≤ò

        function startSnailLoop() {
            const cvs = document.getElementById('snailCanvas');
            const ctx = cvs.getContext('2d');
            function draw() {
                ctx.fillStyle = "#2c1e14"; ctx.fillRect(0,0,cvs.width, cvs.height); // Ìùô ÏÉâÏÉÅ
                ctx.globalAlpha = 0.3; ctx.drawImage(soilImg, 0, 0, cvs.width, cvs.height); ctx.globalAlpha = 1.0;
                
                // Ìä∏Îûô
                ctx.strokeStyle = "#444";
                for(let i=1; i<3; i++) { ctx.beginPath(); ctx.moveTo(0, i*100); ctx.lineTo(cvs.width, i*100); ctx.stroke(); }
                // Í≤∞ÏäπÏÑ†
                ctx.fillStyle = "#f1c40f"; ctx.fillRect(750, 0, 10, 300);

                for(let i=0; i<3; i++) {
                    ctx.drawImage(snailImg, snailPos[i], i*100 + 20, 60, 60);
                }
                requestAnimationFrame(draw);
            }
            draw();
        }

        window.runSnail = async () => {
            const bet = parseInt(document.getElementById('snail-bet').value);
            const pick = parseInt(document.querySelector('input[name="spick"]:checked').value);
            if(bet > userData.balance || bet <= 0) return alert("ÏûîÏï° Î∂ÄÏ°±");
            await updateDoc(doc(db, "users", auth.currentUser.uid), { balance: increment(-bet) });
            refresh();

            const race = setInterval(async () => {
                let winner = -1;
                for(let i=0; i<3; i++) {
                    snailPos[i] += Math.random()*5;
                    if(snailPos[i] >= 700) winner = i;
                }
                if(winner !== -1) {
                    clearInterval(race);
                    const win = winner === pick;
                    const profit = win ? Math.floor(bet * 2.9) : 0;
                    alert(win ? "ÏäπÎ¶¨!" : "Ìå®Î∞∞..");
                    await updateDoc(doc(db, "users", auth.currentUser.uid), {
                        balance: increment(profit),
                        history: arrayUnion({ game: 'snail', bet, profit: profit-bet, time: new Date().toISOString() })
                    });
                    snailPos = [10, 10, 10]; refresh();
                }
            }, 30);
        };

        window.setMax = (id) => { document.getElementById(id).value = userData.balance; };

    </script>
</head>
<body>

    <div id="login" class="view active-view">
        <div style="max-width:380px; margin: 120px auto; padding: 0 20px;">
            <h1 class="logo" style="font-size:45px; text-align:center; margin-bottom:10px;">SUPER <span>9</span> BET</h1>
            <p style="text-align:center; color:#555; margin-bottom:40px; font-weight:700;">PREMIUM MEMBERS ONLY</p>
            <input type="email" id="email" placeholder="Ïù¥Î©îÏùº Ï£ºÏÜå">
            <input type="password" id="pw" placeholder="ÎπÑÎ∞ÄÎ≤àÌò∏">
            <button class="btn-main" onclick="login()">LOGIN</button>
        </div>
    </div>

    <div id="lobby" class="view">
        <div class="app-header">
            <div class="logo">SUPER <span>9</span> BET</div>
            <div class="balance-badge">‚Ç© <span class="balance-val">0</span></div>
        </div>
        <div class="game-grid">
            <div class="game-item" onclick="showView('slotGame')">
                <div class="game-img" style="background-image:url('https://images.unsplash.com/photo-1596838132731-3301c3fd4317?w=400');"></div>
                <div class="game-name">Îü≠ÌÇ§ 777 Ïä¨Î°Ø (17.7x)</div>
            </div>
            <div class="game-item" onclick="showView('bacGame')">
                <div class="game-img" style="background-image:url('https://images.unsplash.com/photo-1511193311914-0346f16efe90?w=400');"></div>
                <div class="game-name">VIP Î∞îÏπ¥Îùº (10x TIE)</div>
            </div>
            <div class="game-item" onclick="showView('snailGame')" style="grid-column: span 2;">
                <div class="game-img" style="background-image:url('https://img.freepik.com/free-photo/snail-action-fantasy-nature_23-2150274577.jpg');"></div>
                <div class="game-name">Ïä§ÌîºÎìú Îã¨ÌåΩÏù¥ Î†àÏù¥Ïã±</div>
            </div>
        </div>
    </div>

    <div id="slotGame" class="view">
        <div class="app-header">
            <div onclick="showView('lobby')"><i class="fa-solid fa-chevron-left"></i></div>
            <div class="balance-badge">‚Ç© <span class="balance-val">0</span></div>
        </div>
        <div class="ingame-card">
            <h2 style="text-align:center; color:var(--text-gold);">üé∞ LUCKY 777 SLOT</h2>
            <div class="slot-machine">
                <div class="reel" id="r1">üí∞</div>
                <div class="reel" id="r2">üíé</div>
                <div class="reel" id="r3">7</div>
            </div>
            <div style="display:flex; align-items:center; margin-bottom:10px;">
                <input type="number" id="slot-bet" value="10000" style="margin:0;">
                <button class="btn-max" onclick="setMax('slot-bet')">MAX</button>
            </div>
            <button class="btn-main" onclick="runSlot()">SPIN</button>
        </div>
    </div>

    <div id="bacGame" class="view">
        <div class="app-header">
            <div onclick="showView('lobby')"><i class="fa-solid fa-chevron-left"></i></div>
            <div class="balance-badge">‚Ç© <span class="balance-val">0</span></div>
        </div>
        <div class="ingame-card">
            <h2 style="text-align:center; color:var(--text-gold);">üÉè VIP BACCARAT</h2>
            <div class="baccarat-table">
                <div class="card-slot">
                    <div style="color:#4285f4; font-weight:900; margin-bottom:10px;">PLAYER</div>
                    <div id="p-card" class="playing-card card-hidden">0</div>
                </div>
                <div class="card-slot">
                    <div style="color:#ea4335; font-weight:900; margin-bottom:10px;">BANKER</div>
                    <div id="b-card" class="playing-card card-hidden">0</div>
                </div>
            </div>
            <div style="display:flex; align-items:center; margin-bottom:15px;">
                <input type="number" id="bac-bet" value="10000" style="margin:0;">
                <button class="btn-max" onclick="setMax('bac-bet')">MAX</button>
            </div>
            <div style="display:grid; grid-template-columns: 1fr 1fr 1fr; gap:10px;">
                <button class="btn-main" style="background:#4285f4; color:#fff;" onclick="runBac('player')">P (2Î∞∞)</button>
                <button class="btn-main" style="background:#34a853; color:#fff;" onclick="runBac('tie')">T (10Î∞∞)</button>
                <button class="btn-main" style="background:#ea4335; color:#fff;" onclick="runBac('banker')">B (2Î∞∞)</button>
            </div>
        </div>
    </div>

    <div id="snailGame" class="view">
        <div class="app-header">
            <div onclick="showView('lobby')"><i class="fa-solid fa-chevron-left"></i></div>
            <div class="balance-badge">‚Ç© <span class="balance-val">0</span></div>
        </div>
        <div class="ingame-card" style="max-width:850px;">
            <h2 style="text-align:center; color:var(--text-gold);">üêå SNAIL RACING</h2>
            <canvas id="snailCanvas" width="800" height="300" style="width:100%; border-radius:10px;"></canvas>
            <div style="display:flex; justify-content:center; gap:20px; margin:20px 0;">
                <label><input type="radio" name="spick" value="0" checked> 1Î≤à</label>
                <label><input type="radio" name="spick" value="1"> 2Î≤à</label>
                <label><input type="radio" name="spick" value="2"> 3Î≤à</label>
            </div>
            <div style="display:flex; align-items:center; margin-bottom:15px;">
                <input type="number" id="snail-bet" value="10000" style="margin:0;">
                <button class="btn-max" onclick="setMax('snail-bet')">MAX</button>
            </div>
            <button class="btn-main" onclick="runSnail()">RACE START</button>
        </div>
    </div>

</body>
</html>