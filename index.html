<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>S SUPER 9 BET | ê³µì‹ ë¼ì´ë¸Œ ë² íŒ…</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --main-green: #388e3c;
            --dark-bg: #1e1e1e;
            --sidebar-bg: #121212;
            --point-gold: #eebb4d;
            --header-gradient: linear-gradient(to bottom, #4caf50, #2e7d32);
        }

        body {
            background-color: #000; color: #eee;
            font-family: 'Noto Sans KR', sans-serif; margin: 0; padding: 0;
            overflow-x: hidden;
        }

        /* --- ìƒë‹¨ í—¤ë” (ì°¸ì¡° ì´ë¯¸ì§€ ìŠ¤íƒ€ì¼) --- */
        .top-nav {
            background: var(--header-gradient); height: 50px;
            display: flex; justify-content: space-between; align-items: center;
            padding: 0 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.5);
        }
        .logo-area { font-size: 24px; font-weight: 900; color: #fff; font-style: italic; }
        .logo-area span { color: #ffeb3b; }
        
        .user-info-bar { background: #222; padding: 10px 20px; display: flex; gap: 20px; font-size: 13px; border-bottom: 1px solid #333; }
        .balance-val { color: var(--point-gold); font-weight: bold; }

        /* --- ì „ì²´ ë ˆì´ì•„ì›ƒ --- */
        .main-wrapper { display: flex; min-height: calc(100vh - 90px); }
        
        /* ì¢Œì¸¡ ì‚¬ì´ë“œë°” */
        .sidebar { width: 220px; background: var(--sidebar-bg); border-right: 1px solid #333; padding-top: 20px; }
        .menu-group { margin-bottom: 25px; }
        .menu-title { padding: 5px 20px; font-size: 12px; color: #666; font-weight: bold; border-bottom: 1px solid #222; margin-bottom: 10px; }
        .menu-item { padding: 12px 25px; font-size: 14px; cursor: pointer; transition: 0.3s; display: flex; justify-content: space-between; }
        .menu-item:hover { background: #222; color: var(--point-gold); }
        .menu-item i { font-size: 12px; opacity: 0.5; }

        /* ë©”ì¸ ì½˜í…ì¸  êµ¬ì—­ */
        .content { flex: 1; padding: 20px; background: #1a1a1a; }
        .ticker { background: #000; border: 1px solid #444; padding: 8px 15px; font-size: 13px; color: #8bc34a; margin-bottom: 20px; border-radius: 4px; }

        /* --- ê²Œì„ ì„¹ì…˜ ìŠ¤íƒ€ì¼ --- */
        .view { display: none; }
        .active-view { display: block; animation: fadeIn 0.3s; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* ìŠ¬ë¡¯ ë¨¸ì‹  */
        .slot-wrap { background: #000; border: 3px solid #444; border-radius: 10px; padding: 20px; display: flex; justify-content: center; gap: 15px; margin-bottom: 20px; }
        .reel { width: 90px; height: 120px; background: #111; border: 1px solid #333; display: flex; align-items: center; justify-content: center; font-size: 60px; border-radius: 8px; }

        /* ë¦¬ì–¼ ë°”ì¹´ë¼ í…Œì´ë¸” */
        .bac-table { background: radial-gradient(circle, #1b5e20 0%, #0d2a10 100%); border: 10px solid #2e1b0f; border-radius: 100px; height: 300px; position: relative; margin-bottom: 20px; display: flex; justify-content: center; align-items: center; gap: 50px; }
        .card-box { text-align: center; width: 150px; }
        .card-img { width: 70px; height: 100px; background: #fff url('https://deckofcardsapi.com/static/img/back.png') center/cover; border-radius: 5px; margin: 5px; display: inline-block; transition: 0.6s; }
        .card-open { transform: rotateY(180deg); }

        /* ê³µí†µ ë²„íŠ¼/ì…ë ¥ì°½ */
        .bet-box { background: #222; padding: 20px; border-radius: 8px; border: 1px solid #333; }
        .input-row { display: flex; align-items: center; background: #000; border: 1px solid #444; border-radius: 5px; padding: 5px 15px; margin-bottom: 15px; }
        .input-row input { background: transparent; border: none; color: var(--point-gold); padding: 10px; width: 100%; font-size: 18px; font-weight: bold; outline: none; }
        .btn-max { background: #444; border: none; color: #fff; padding: 5px 10px; border-radius: 3px; cursor: pointer; font-size: 11px; }
        .btn-bet { background: var(--header-gradient); border: none; color: #fff; padding: 15px; width: 100%; font-size: 18px; font-weight: bold; border-radius: 5px; cursor: pointer; }
        .btn-bet:hover { filter: brightness(1.2); }

    </style>
</head>
<body>

    <div class="top-nav">
        <div class="logo-area">S <span>SUPER 9 BET</span></div>
        <div style="font-size: 13px; font-weight: bold;">
            ë¡œê·¸ì•„ì›ƒ | ë§ˆì´í˜ì´ì§€ | ê³ ê°ì„¼í„°
        </div>
    </div>

    <div class="user-info-bar">
        <div>ì ‘ì†ID: <span style="color:#fff;">Member</span></div>
        <div>ë³´ìœ ë¨¸ë‹ˆ: <span class="balance-val">0</span> KRW</div>
        <div style="margin-left:auto; color:#888;">ìµœê·¼ë‹¹ì²¨: ìŠ¬ë¡¯(777) 17.7ë°° ë‹¹ì²¨!</div>
    </div>

    <div class="main-wrapper">
        <div class="sidebar">
            <div class="menu-group">
                <div class="menu-title">CASINO GAME</div>
                <div class="menu-item" onclick="showView('slotView')">ëŸ­í‚¤ í›„ë¥´ì¸  ìŠ¬ë¡¯ <i class="fa-solid fa-play"></i></div>
                <div class="menu-item" onclick="showView('bacView')">VIP ë¼ì´ë¸Œ ë°”ì¹´ë¼ <i class="fa-solid fa-play"></i></div>
            </div>
            <div class="menu-group">
                <div class="menu-title">MINI GAME</div>
                <div class="menu-item" onclick="showView('snailView')">ì‹¤ì‹œê°„ ë‹¬íŒ½ì´ ë ˆì´ìŠ¤ <i class="fa-solid fa-play"></i></div>
                <div class="menu-item">íŒŒì›Œë³¼ ë¦¬í„´ì¦ˆ <i class="fa-solid fa-lock"></i></div>
            </div>
        </div>

        <div class="content">
            <div class="ticker">
                <i class="fa-solid fa-bullhorn"></i> [ê³µì§€] ìœ ì‚¬/ì‚¬ì¹­ ì‚¬ì´íŠ¸ ì£¼ì˜ì•ˆë‚´ - ì €í¬ SUPER 9 BETì€ ë³„ë„ì˜ ì¶©ì „ ìœ ë„ ë¬¸ìë¥¼ ë°œì†¡í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
            </div>

            <div id="slotView" class="view active-view">
                <div class="bet-box">
                    <h2 style="margin-top:0;">ğŸ° LUCKY 777 SLOT</h2>
                    <div class="slot-wrap">
                        <div class="reel" id="r1">7</div>
                        <div class="reel" id="r2">7</div>
                        <div class="reel" id="r3">7</div>
                    </div>
                    <div class="input-row">
                        <input type="number" id="slot-bet" value="10000">
                        <button class="btn-max" onclick="maxBet('slot-bet')">MAX</button>
                    </div>
                    <button class="btn-bet" onclick="playSlot()">SPIN START</button>
                </div>
            </div>

            <div id="bacView" class="view">
                <div class="bet-box">
                    <h2 style="margin-top:0;">ğŸƒ REAL LIVE BACCARAT</h2>
                    <div class="bac-table">
                        <div class="card-box" id="player-zone">
                            <div style="color:#4facfe; font-weight:900;">PLAYER</div>
                            <div id="p-cards"></div>
                        </div>
                        <div class="card-box" id="banker-zone">
                            <div style="color:#ff0844; font-weight:900;">BANKER</div>
                            <div id="b-cards"></div>
                        </div>
                    </div>
                    <div class="input-row">
                        <input type="number" id="bac-bet" value="10000">
                        <button class="btn-max" onclick="maxBet('bac-bet')">MAX</button>
                    </div>
                    <div style="display:grid; grid-template-columns: 1fr 1fr 1fr; gap:10px;">
                        <button class="btn-bet" style="background:#4facfe;" onclick="playBac('player')">í”Œë ˆì´ì–´ (2x)</button>
                        <button class="btn-bet" style="background:#8bc34a;" onclick="playBac('tie')">íƒ€ì´ (10x)</button>
                        <button class="btn-bet" style="background:#ff0844;" onclick="playBac('banker')">ë±…ì»¤ (2x)</button>
                    </div>
                </div>
            </div>

            <div id="snailView" class="view">
                <div class="bet-box">
                    <h2 style="margin-top:0;">ğŸŒ REAL SNAIL RACING</h2>
                    <canvas id="snailCanvas" width="800" height="300" style="width:100%; border:2px solid #444; border-radius:5px;"></canvas>
                    <div style="display:flex; justify-content:center; gap:30px; margin:20px 0; font-weight:bold;">
                        <label><input type="radio" name="spick" value="0" checked> 1ë²ˆ ë‹¬íŒ½ì´</label>
                        <label><input type="radio" name="spick" value="1"> 2ë²ˆ ë‹¬íŒ½ì´</label>
                        <label><input type="radio" name="spick" value="2"> 3ë²ˆ ë‹¬íŒ½ì´</label>
                    </div>
                    <div class="input-row">
                        <input type="number" id="snail-bet" value="10000">
                        <button class="btn-max" onclick="maxBet('snail-bet')">MAX</button>
                    </div>
                    <button class="btn-bet" onclick="playSnail()">RACE START</button>
                </div>
            </div>

        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-app.js";
        import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-auth.js";
        import { getFirestore, doc, getDoc, updateDoc, increment, arrayUnion } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore.js";

        const firebaseConfig = { apiKey: "AIzaSyDOVJtg5lxJTBP2Vm1mzbuecKu9Rg-I4k4", authDomain: "gambling-23339.firebaseapp.com", projectId: "gambling-23339", storageBucket: "gambling-23339.firebasestorage.app", messagingSenderId: "1031894079454", appId: "1:1031894079454:web:960ca0f1748493cdd9af4f" };
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        let userData = { balance: 0 };

        window.showView = (id) => {
            document.querySelectorAll('.view').forEach(v => v.classList.remove('active-view'));
            document.getElementById(id).classList.add('active-view');
            if(id === 'snailView') initSnail();
        };

        const updateUI = async () => {
            if(!auth.currentUser) return;
            const snap = await getDoc(doc(db, "users", auth.currentUser.uid));
            userData = snap.data();
            document.querySelectorAll('.balance-val').forEach(el => el.innerText = userData.balance.toLocaleString());
        };

        onAuthStateChanged(auth, (user) => { if(user) updateUI(); });

        window.maxBet = (id) => document.getElementById(id).value = userData.balance;

        // --- [ê²Œì„ 1] ìŠ¬ë¡¯ë¨¸ì‹  ---
        const symbols = ['ğŸ', 'ğŸŠ', 'ğŸ‡', 'ğŸ’', 'ğŸ’', '7', 'ğŸ‰', 'ğŸ‹', 'ğŸ’°'];
        window.playSlot = async () => {
            const bet = parseInt(document.getElementById('slot-bet').value);
            if(bet > userData.balance || bet <= 0) return alert("ì”ì•¡ ë¶€ì¡±");
            await updateDoc(doc(db, "users", auth.currentUser.uid), { balance: increment(-bet) });
            updateUI();

            const reels = [document.getElementById('r1'), document.getElementById('r2'), document.getElementById('r3')];
            let count = 0;
            const spin = setInterval(() => {
                reels.forEach(r => r.innerText = symbols[Math.floor(Math.random()*9)]);
                if(++count > 25) {
                    clearInterval(spin);
                    const res = reels.map(r => r.innerText);
                    let multi = (res[0]==='7' && res[1]==='7' && res[2]==='7') ? 17.7 : 
                                (res[0]===res[1] && res[1]===res[2]) ? 2 : 
                                (res[0]===res[1] || res[1]===res[2] || res[0]===res[2]) ? 1 : 0;
                    
                    finishGame('slot', bet, multi);
                }
            }, 50);
        };

        // --- [ê²Œì„ 2] ë¦¬ì–¼ ë°”ì¹´ë¼ (ìŠ¬ë¡œìš° ë”œë§) ---
        window.playBac = async (pick) => {
            const bet = parseInt(document.getElementById('bac-bet').value);
            if(bet > userData.balance || bet <= 0) return alert("ì”ì•¡ ë¶€ì¡±");
            await updateDoc(doc(db, "users", auth.currentUser.uid), { balance: increment(-bet) });
            updateUI();

            const pZone = document.getElementById('p-cards');
            const bZone = document.getElementById('b-cards');
            pZone.innerHTML = ''; bZone.innerHTML = '';

            const getCard = () => ({ val: Math.floor(Math.random()*9) + 1, img: `https://deckofcardsapi.com/static/img/${Math.floor(Math.random()*10)}S.png` });

            // ì¹´ë“œ í•œ ì¥ì”© ë”œë§ ëª¨ì…˜
            const delay = (ms) => new Promise(res => setTimeout(res, ms));
            
            let p1 = getCard(), b1 = getCard(), p2 = getCard(), b2 = getCard();
            
            const addCard = (zone, card) => {
                const el = document.createElement('div'); el.className = 'card-img';
                zone.appendChild(el);
                setTimeout(() => { el.style.backgroundImage = `url(${card.img})`; el.classList.add('card-open'); }, 100);
            };

            addCard(pZone, p1); await delay(800);
            addCard(bZone, b1); await delay(800);
            addCard(pZone, p2); await delay(800);
            addCard(bZone, b2); await delay(800);

            let pSum = (p1.val + p2.val) % 10;
            let bSum = (b1.val + b2.val) % 10;

            // 3ë²ˆì§¸ ì¹´ë“œ ì¡°ê±´ (ê°„ëµí™”)
            if(pSum <= 5) { let p3 = getCard(); addCard(pZone, p3); pSum = (pSum + p3.val) % 10; await delay(800); }

            const win = pSum > bSum ? 'player' : (bSum > pSum ? 'banker' : 'tie');
            const multi = (pick === win) ? (win === 'tie' ? 10 : 2) : 0;
            finishGame('baccarat', bet, multi);
        };

        // --- [ê²Œì„ 3] ì‹¤ì‚¬ ë‹¬íŒ½ì´ ë ˆì´ìŠ¤ ---
        const snailImg = new Image(); snailImg.src = "https://cdn-icons-png.flaticon.com/512/826/826912.png"; // ì‹¤ì‚¬í˜• ì•„ì´ì½˜
        let snails = [10, 10, 10];
        window.initSnail = () => {
            const cvs = document.getElementById('snailCanvas');
            const ctx = cvs.getContext('2d');
            function draw() {
                ctx.fillStyle = "#3e2723"; ctx.fillRect(0,0,800,300); // í™ë°”ë‹¥
                ctx.strokeStyle = "#5d4037"; for(let i=1;i<3;i++){ ctx.beginPath();ctx.moveTo(0,i*100);ctx.lineTo(800,i*100);ctx.stroke(); }
                // ê²°ìŠ¹ì„ 
                for(let i=0;i<300;i+=20){ ctx.fillStyle= (i/20)%2===0?"#fff":"#000"; ctx.fillRect(760,i,20,20); ctx.fillRect(780,i+10,20,20); }
                snails.forEach((pos, i) => ctx.drawImage(snailImg, pos, i*100 + 10, 80, 80));
                requestAnimationFrame(draw);
            }
            draw();
        };

        window.playSnail = async () => {
            const bet = parseInt(document.getElementById('snail-bet').value);
            const pick = parseInt(document.querySelector('input[name="spick"]:checked').value);
            if(bet > userData.balance || bet <= 0) return alert("ì”ì•¡ ë¶€ì¡±");
            await updateDoc(doc(db, "users", auth.currentUser.uid), { balance: increment(-bet) });
            updateUI();

            const timer = setInterval(() => {
                let win = -1;
                snails = snails.map((p, i) => {
                    const next = p + Math.random() * 4;
                    if(next >= 700) win = i;
                    return next;
                });
                if(win !== -1) {
                    clearInterval(timer);
                    finishGame('snail', bet, (win === pick ? 2.9 : 0));
                    setTimeout(() => { snails = [10, 10, 10]; }, 2000);
                }
            }, 30);
        };

        const finishGame = async (name, bet, multi) => {
            const profit = Math.floor(bet * multi);
            await updateDoc(doc(db, "users", auth.currentUser.uid), {
                balance: increment(profit),
                history: arrayUnion({ game: name, bet, profit: profit - bet, time: new Date().toISOString() })
            });
            updateUI();
            if(multi > 0) alert(`[ë‹¹ì²¨] ${multi}ë°° ë°°ë‹¹ê¸ˆ ${profit.toLocaleString()}ì›ì´ ì§€ê¸‰ë˜ì—ˆìŠµë‹ˆë‹¤!`);
            else alert("ì•„ì‰½ê²Œë„ ë‚™ì²¨ë˜ì—ˆìŠµë‹ˆë‹¤.");
        };

    </script>
</body>
</html>